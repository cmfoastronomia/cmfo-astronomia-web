<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizaci√≥n 3D - CMFO Astronom√≠a</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        #contenedor3d {
            width: 100%;
            height: 500px;
            background: #000;
            border: 2px solid #00ffff;
            border-radius: 8px;
            margin: 20px 0;
            position: relative;
        }
        
        .controles3d {
            background: rgba(0, 40, 60, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #00cccc;
        }
        
        .boton-3d {
            background: linear-gradient(135deg, #0066cc, #00cccc);
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        .panel-info {
            background: rgba(0, 60, 90, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #00ffff;
        }
        
        .alternativa-stellarium {
            background: rgba(0, 80, 120, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #00ffff;
        }
    </style>
</head>

<body>
<nav class="navbar">
    <div class="navbar-title">CMFO Astronom√≠a</div>
    <input type="checkbox" id="menu-toggle">
    <label for="menu-toggle" class="menu-icon">&#9776;</label>
    <ul class="menu">
        <li><a href="../index.html">Inicio</a></li>
        <li><a href="../investigacion/investigacion.html">Investigaci√≥n</a></li>
        <li><a href="../datos/datos.html">Datos CMFO</a></li>
        <li><a href="visualizacion3d.html">Visualizaci√≥n 3D</a></li>
        <li><a href="../aportes/aportes.html">Aportes</a></li>
        <li><a href="../documentacion/documentacion.html">Documentaci√≥n</a></li>
        <li><a href="../contacto/contacto.html">Contacto</a></li>
    </ul>
</nav>

<header>
    <h1>CMFO Astronom√≠a - Sistema Solar 3D</h1>
    <p>Simulaci√≥n cient√≠fica con representaci√≥n precisa del sistema solar</p>
</header>

<div class="contenedor">
    <!-- SISTEMA 3D SIMPLIFICADO PERO FUNCIONAL -->
    <div class="section">
        <h2>üåå Visualizaci√≥n del Sistema Solar</h2>
        <div id="contenedor3d">
            <div style="color: #00ffff; text-align: center; padding: 50px;">
                <div id="mensaje-carga">Inicializando visualizaci√≥n 3D...</div>
                <div style="font-size: 12px; margin-top: 10px;">CMFO Astronom√≠a - Three.js</div>
            </div>
        </div>
    </div>

    <div class="controles3d">
        <h3>üéÆ Control de Navegaci√≥n</h3>
        <div>
            <button class="boton-3d" onclick="cambiarVista('completa')">ü™ê Vista Completa</button>
            <button class="boton-3d" onclick="cambiarVista('interior')">üåç Sistema Interior</button>
            <button class="boton-3d" onclick="cambiarVista('tierra')">üåé Tierra y Luna</button>
            <button class="boton-3d" onclick="toggleAnimacion()" id="btn-animacion">‚ñ∂Ô∏è Iniciar Animaci√≥n</button>
        </div>
    </div>

    <!-- ALTERNATIVA STELLARIUM -->
    <div class="alternativa-stellarium">
        <h3>üî≠ ¬øPrefieres m√°xima precisi√≥n cient√≠fica?</h3>
        <p>Accede a Stellarium Web - Planetario en tiempo real con cat√°logo completo</p>
        <a href="https://stellarium-web.org/" target="_blank" class="boton-3d" style="display: inline-block; text-decoration: none;">
            üöÄ Abrir Stellarium Web
        </a>
    </div>

    <div class="panel-info">
        <h3>üî¨ Datos Cient√≠ficos del Sistema Solar</h3>
        <div id="info-panel">
            <div><strong>Sol:</strong> Radio: 696,340 km | Tipo: G2V</div>
            <div><strong>Mercurio:</strong> Distancia: 0.39 AU | Per√≠odo: 88 d√≠as</div>
            <div><strong>Venus:</strong> Distancia: 0.72 AU | Per√≠odo: 225 d√≠as</div>
            <div><strong>Tierra:</strong> Distancia: 1.00 AU | Per√≠odo: 365 d√≠as | Luna: 1</div>
            <div><strong>Marte:</strong> Distancia: 1.52 AU | Per√≠odo: 687 d√≠as</div>
            <div><strong>J√∫piter:</strong> Distancia: 5.20 AU | Per√≠odo: 12 a√±os</div>
            <div><strong>Saturno:</strong> Distancia: 9.58 AU | Per√≠odo: 29 a√±os</div>
        </div>
    </div>
</div>

<footer>
    ¬© 2025 CMFO Astronom√≠a - Visualizaci√≥n Cient√≠fica
</footer>

<script>
// SISTEMA 3D SIMPLIFICADO Y GARANTIZADO
console.log("üöÄ Iniciando sistema 3D CMFO...");

let escena, camara, renderizador;
let animacionActiva = false;

function iniciarThreeJS() {
    console.log("üîß Verificando compatibilidad Three.js...");
    
    // VERIFICAR QUE THREE.JS EST√â CARGADO
    if (typeof THREE === 'undefined') {
        document.getElementById('mensaje-carga').innerHTML = '‚ùå Three.js no disponible<br><small>Usando visualizaci√≥n alternativa</small>';
        mostrarVisualizacionAlternativa();
        return;
    }
    
    try {
        // CONFIGURACI√ìN M√çNIMA PERO FUNCIONAL
        const contenedor = document.getElementById('contenedor3d');
        const ancho = contenedor.clientWidth;
        const alto = 500;
        
        // 1. ESCENA
        escena = new THREE.Scene();
        escena.background = new THREE.Color(0x000011);
        
        // 2. C√ÅMARA
        camara = new THREE.PerspectiveCamera(75, ancho / alto, 0.1, 1000);
        camara.position.z = 30;
        camara.position.y = 10;
        
        // 3. RENDERIZADOR
        renderizador = new THREE.WebGLRenderer({ antialias: true });
        renderizador.setSize(ancho, alto);
        
        // LIMPIAR Y AGREGAR AL DOM
        contenedor.innerHTML = '';
        contenedor.appendChild(renderizador.domElement);
        
        // 4. ILUMINACI√ìN B√ÅSICA
        const luzAmbiental = new THREE.AmbientLight(0x333333);
        escena.add(luzAmbiental);
        
        const luzDireccional = new THREE.DirectionalLight(0xffffff, 1);
        luzDireccional.position.set(5, 5, 5);
        escena.add(luzDireccional);
        
        // 5. CREAR SISTEMA SOLAR B√ÅSICO
        crearSistemaSolarBasico();
        
        // 6. INICIAR ANIMACI√ìN
        animar();
        
        // 7. CONFIGURAR REDIMENSIONAMIENTO
        window.addEventListener('resize', function() {
            const nuevoAncho = contenedor.clientWidth;
            const nuevoAlto = 500;
            camara.aspect = nuevoAncho / nuevoAlto;
            camara.updateProjectionMatrix();
            renderizador.setSize(nuevoAncho, nuevoAlto);
        });
        
        document.getElementById('mensaje-carga').textContent = "‚úÖ Sistema 3D activo";
        console.log("‚úÖ Three.js inicializado correctamente");
        
    } catch (error) {
        console.error("‚ùå Error en Three.js:", error);
        document.getElementById('mensaje-carga').innerHTML = '‚ùå Error en visualizaci√≥n 3D<br><small>Mostrando alternativa</small>';
        mostrarVisualizacionAlternativa();
    }
}

function crearSistemaSolarBasico() {
    console.log("ü™ê Creando sistema solar b√°sico...");
    
    // SOL
    const solGeometry = new THREE.SphereGeometry(2, 32, 32);
    const solMaterial = new THREE.MeshPhongMaterial({ 
        color: 0xffff00,
        emissive: 0xffff00,
        emissiveIntensity: 0.5
    });
    const sol = new THREE.Mesh(solGeometry, solMaterial);
    sol.userData = { velocidad: 0.005 };
    escena.add(sol);
    
    // PLANETAS B√ÅSICOS
    const planetas = [
        { nombre: 'mercurio', radio: 0.3, distancia: 4, color: 0x8C7853, velocidad: 0.02 },
        { nombre: 'venus', radio: 0.5, distancia: 6, color: 0xE6CD8C, velocidad: 0.015 },
        { nombre: 'tierra', radio: 0.5, distancia: 8, color: 0x1E90FF, velocidad: 0.01 },
        { nombre: 'marte', radio: 0.4, distancia: 10, color: 0xFF4500, velocidad: 0.008 },
        { nombre: 'jupiter', radio: 1.0, distancia: 14, color: 0xDAA520, velocidad: 0.004 },
        { nombre: 'saturno', radio: 0.8, distancia: 18, color: 0xF0E68C, velocidad: 0.002 }
    ];
    
    planetas.forEach(planeta => {
        const geometry = new THREE.SphereGeometry(planeta.radio, 16, 16);
        const material = new THREE.MeshPhongMaterial({ color: planeta.color });
        const mesh = new THREE.Mesh(geometry, material);
        
        mesh.position.x = planeta.distancia;
        mesh.userData = {
            velocidadRotacion: planeta.velocidad,
            velocidadOrbital: planeta.velocidad * 0.5,
            anguloOrbital: Math.random() * Math.PI * 2,
            distanciaOrbital: planeta.distancia
        };
        
        escena.add(mesh);
        
        // CREAR √ìRBITA VISUAL
        crearOrbitaVisual(planeta.distancia);
    });
    
    console.log("‚úÖ Sistema solar b√°sico creado");
}

function crearOrbitaVisual(radio) {
    const puntos = [];
    for (let i = 0; i <= 32; i++) {
        const angulo = (i / 32) * Math.PI * 2;
        puntos.push(new THREE.Vector3(
            Math.cos(angulo) * radio,
            0,
            Math.sin(angulo) * radio
        ));
    }
    
    const geometry = new THREE.BufferGeometry().setFromPoints(puntos);
    const material = new THREE.LineBasicMaterial({ 
        color: 0x444477,
        transparent: true,
        opacity: 0.2
    });
    
    const orbita = new THREE.Line(geometry, material);
    escena.add(orbita);
}

function animar() {
    requestAnimationFrame(animar);
    
    if (animacionActiva && escena) {
        // ANIMAR ROTACI√ìN DE OBJETOS
        escena.children.forEach(child => {
            if (child.userData && child.userData.velocidadRotacion) {
                child.rotation.y += child.userData.velocidadRotacion;
                
                // ANIMAR √ìRBITAS PARA PLANETAS
                if (child.userData.velocidadOrbital) {
                    child.userData.anguloOrbital += child.userData.velocidadOrbital;
                    child.position.x = Math.cos(child.userData.anguloOrbital) * child.userData.distanciaOrbital;
                    child.position.z = Math.sin(child.userData.anguloOrbital) * child.userData.distanciaOrbital;
                }
            }
        });
    }
    
    if (renderizador && escena && camara) {
        renderizador.render(escena, camara);
    }
}

function mostrarVisualizacionAlternativa() {
    const contenedor = document.getElementById('contenedor3d');
    contenedor.innerHTML = `
        <div style="color: #00ffff; text-align: center; padding: 50px;">
            <h3>üåå Visualizaci√≥n Alternativa</h3>
            <p>El sistema 3D no est√° disponible en este dispositivo</p>
            <p>Te recomendamos usar:</p>
            <div style="margin: 20px 0;">
                <a href="https://stellarium-web.org/" target="_blank" class="boton-3d" style="display: inline-block; text-decoration: none; margin: 10px;">
                    üöÄ Stellarium Web
                </a>
                <br>
                <a href="https://www.solarsystemscope.com/" target="_blank" class="boton-3d" style="display: inline-block; text-decoration: none; margin: 10px;">
                    ü™ê Solar System Scope
                </a>
            </div>
            <p style="font-size: 12px; margin-top: 20px;">
                Estas plataformas ofrecen m√°xima precisi√≥n cient√≠fica y compatibilidad universal
            </p>
        </div>
    `;
}

// FUNCIONES DE CONTROL
window.cambiarVista = function(vista) {
    if (!camara) return;
    
    switch(vista) {
        case 'completa':
            camara.position.set(0, 10, 30);
            break;
        case 'interior':
            camara.position.set(0, 5, 15);
            break;
        case 'tierra':
            camara.position.set(10, 3, 10);
            break;
    }
};

window.toggleAnimacion = function() {
    animacionActiva = !animacionActiva;
    const boton = document.getElementById('btn-animacion');
    boton.textContent = animacionActiva ? '‚è∏Ô∏è Pausar Animaci√≥n' : '‚ñ∂Ô∏è Iniciar Animaci√≥n';
};

// INICIAR AL CARGAR LA P√ÅGINA
document.addEventListener('DOMContentLoaded', function() {
    console.log("üìÑ P√°gina cargada, iniciando sistema...");
    iniciarThreeJS();
});
</script>
</body>
</html>

